
# TTL （Time-To-Live Extensions）过期时间
[Time-To-Live Extensions](https://www.rabbitmq.com/ttl.html)       

通过设置policy进行设置
```
rabbitmqctl set_policy TTL ".*" '{"message-ttl":60000}' --apply-to queuesrabbitmqctl
```

## 设置Message的过期时间
#### 设置queue中Message的TTL
```
Map<String, Object> args = new HashMap<String, Object>();
args.put("x-message-ttl", 60000);
channel.queueDeclare("myqueue", false, false, false, args);
```

#### 设置Message的过期时间
```
byte[] messageBodyBytes = "Hello, world!".getBytes();
AMQP.BasicProperties properties = new AMQP.BasicProperties.Builder()
                                   .expiration("60000")
                                   .build();
channel.basicPublish("my-exchange", "routing-key", properties, messageBodyBytes);
```

## 设置队列的过期时间
使用policy设置
```
rabbitmqctl set_policy expiry ".*" '{"expires":1800000}' --apply-to queuesrabbitmqctl
```

程序设置
```
Map<String, Object> args = new HashMap<String, Object>();
args.put("x-expires", 1800000);
channel.queueDeclare("myqueue", false, false, false, args);
```
